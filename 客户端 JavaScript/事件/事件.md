# 事件

## 第一部分： 事件流

> 事件流描述的是从页面中接收事件的顺序

### 1.1 事件冒泡

> IE的事件流叫做事件冒泡, 即事件开始时由最具体的元素(文档中嵌套层次最深的那个节点)接收, 然后逐级向上传播到较为不具体的节点(文档).

### 1.2 事件捕获

> 事件捕获的思想是不太具体的节点应该更早接收到事件, 而最具体的节点应该最后接收到事件.

****

> 尽管"DOM2级事件"规范要求事件应该从document对象开始传播, 但浏览器都是从window对象开始捕获事件的.

### 1.3 DOM事件流

> "DOM2级事件"规定的事件流包括三个阶段: 事件捕获阶段、处于目标阶段和事件冒泡阶段。
>
> 事件捕获阶段：为截获事件提供了机会



****



## 第二部分：事件处理程序

> 响应某个事件的函数就叫做事件处理程序

### 2.1 HTML事件处理程序

### 2.2 DOM0级事件处理程序

> 将一个函数赋值给一个事件处理程序属性
>
> ```javascript
> // 会在事件流的冒泡阶段被处理
> var btn = document.getElementById("myBtn");
> btn.onclick = function(){
> 	alert("Clicked");
> };
> btn.onclick = null; //删除事件处理程序
> ```

### 2.3 DOM2事件处理程序

> ```javascript
> /**
> 	 * @name: 添加事件处理程序
>      * @param {要处理的事件名}
>      * @param {作为事件处理程序的函数}
>      * @param {布尔值： true: 表示在捕获阶段调用时间处理程序, false: 表示在冒泡阶段调用事件处理程序 }
>      * @return: 元素对象
>     */
> var btn = document.getElementById("myBtn");
> btn.addEventListener("click", function(){
> alert(this.id);
> }, false);
> 
> var btn = document.getElementById("myBtn");
> var handler = function(){
> alert(this.id);
> };
> btn.addEventListener("click", handler, false);
> /**
> 	 * @name: 移除事件处理程序
>      * @param {要处理的事件名}
>      * @param {作为事件处理程序的函数}
>      * @param {布尔值： true: 表示在捕获阶段调用时间处理程序, false: 表示在冒泡阶段调用事件处理程序 }
>      * @return: 元素对象
>     */
> btn.removeEventListener("click", handler, false); // 这样删除事件处理程序才有效, 事件处理程序函数必须要引用一致
> ```



****



## 第三部分: 事件对象

> 在触发DOM上的某个事件时, 会产生一个事件对象event, 这个对象中包含着所有与事件有关的信息.

### 3.1 所有事件共有的事件对象属性 或 方法

| 属性/方法                  | 类型     | 读/写 | 说明                                                         |
| -------------------------- | -------- | ----- | ------------------------------------------------------------ |
| target                     | Element  | 只读  | 事件的目标                                                   |
| currentTarget              | Element  | 只读  | 其事件处理程序当前正在处理事件的那个元素                     |
| type                       | String   | 只读  | 被触发的事件的类型                                           |
| trusted                    | Boolean  | 只读  | true: 浏览器生成的事件 false: 开发人员通过js创建的           |
| bubbles                    | Boolean  | 只读  | 表明事件是否冒泡                                             |
| cancelable                 | Boolean  | 只读  | 表明是否可以取消事件的默认行为                               |
| defaultPrevented           | Boolean  | 只读  | true: 表示已经调用了preventDefault()(DOM3级新增)             |
| detail                     | Integer  | 只读  | 与事件相关的细节信息                                         |
| eventPhase                 | Integer  | 只读  | 调用事件处理程序的阶段                                       |
| preventDefault()           | Function | 只读  | 取消事件的默认行为.如果cancelable为true, 则可以使用这个方法  |
| stopPropagetion()          | Function | 只读  | 取消事件的进一步捕获或冒泡. 如果bubbles为true, 则可以使用这个方法 |
| stopImmediatePropagetion() | Function | 只读  | 取消事件的进一步捕获或冒泡, 同时阻止任何事件处理程序被调用   |

### 3.2 鼠标事件 - 事件对象

#### 1. 客户区坐标位置

> 客户区: **即浏览器可视区大小**
>
> **鼠标在客户区位置信息保存在clientX 和 clientY 属性中**

![鼠标-客户区](../image/事件-客户区.png '鼠标-客户区')

#### 2. 页面坐标位置

> 页面: 整个页面 (上面滚动的距离 + 客户区 + 下面未显示的距离)
>
> **鼠标在页面位置(相对于页面最上面和最左边)信息保存在 pageX 和 pageY 属性中**
>
> IE8- 不支持

#### 3. 屏幕坐标位置

> 屏幕: 电脑显示屏
>
> **鼠标在屏幕位置信息保存在 screenX和 screenY属性中**

![鼠标-屏幕](../image/事件-屏幕.png '鼠标-屏幕')

#### 4. 修改键

> 按下鼠标时键盘上的某些键的状态也可以影响到所要采取的操作, 这些修改键就是 Shift, Ctrl, Alt, Meta(在window中是window, 在苹果机中是 Cmd 键), 经常用来修改鼠标事件的行为
>
> 在鼠标事件对象中, 分别对应: shiftKey, ctrlKey, altKey, metaKey
>
> 这些属性中都是布尔值, 如果相应的键被按下, 则为true, 否则为false







## 第四部分 事件类型

### 4.1 UI事件

> 指的是那些不一定与用户操作有关的事件

#### 1.  load: 加载完成

> * 在**页面完全加载**后再window上面触发
> * 当**所有框架**都加载完毕时在框架集上面触发
> * 当**图像加载完毕**时在\<img>元素上触发
> * 当嵌入的内容**加载完毕时在\<object>元素上面触发
> * 在有些浏览器, \<script>元素 和 \<link>元素也可以触发

#### 2. unload: 文档被完全卸载

> * 在当前页面卸载时(从页面切换到另一个页面, 也就是重新请求了页面), 在window上面触发事件

#### 3. resize: 窗口被调整

> * 浏览器被调整到一个新的高度或宽度时, 就会在window上触发resize事件
> * 浏览器窗口最小化或最大化时也会触发resize事件

#### 4. scroll: 窗口滚动

> * 浏览器滚动滚动条时在window上触发
> * 当元素可以滚动时, 元素也会触发该事件

#### 5. select: 选择文本框中的一或多个字符时

#### 6.error: 发生错误时

#### 7. abort: 停止下载



### 4.2 焦点事件

> 当焦点从页面中的一个元素移动到另一个元素, 会一次触发下列事件: 
>
> 1. focusout在失去焦点的元素上触发
> 2. focusin在获得焦点的元素上触发
> 3. blur在失去焦点的元素上触发
> 4. DOMFocusOut在失去焦点的元素上触发
> 5. focus在获得焦点的元素上触发
> 6. DOMFocusIn在获得焦点的元素上触发

#### 1. blur: 失去焦点

> 不会冒泡, 可在捕获阶段中侦听到

#### 2. focus: 获得焦点

> 不会冒泡, 可在捕获阶段中侦听到

#### 3. focusin: 获得焦点

> 支持冒泡

#### 4.focusout: 失去焦点

> 支持冒泡

#### 5.DOMFocusOut 和 DOMFocusOut: 已弃用



### 4.3 鼠标和滚轮事件

> 只有在同一个元素上相继触发mousedown和mouseup事件, 才会触发click事件; ***如果mousedown 或 mouseup 中的一个被取消, 就不会触发click事件***
>
> 也就是说, 事件之间是会有联系的
>
> 事件的触发顺序:
>
> 1. mousedown
> 2. mouseup
> 3. click
> 4. mousedown
> 5. mouseup
> 6. click
> 7. dblclick

#### 1. mouseover: 鼠标移入

> 会冒泡

#### 2. mouseout: 鼠标移出

> 会冒泡

#### 3. mouseenter: 鼠标移入

> 不支持冒泡, 常用

#### 4. mouseleave: 鼠标移出

> 不支持冒泡, 常用

#### 5. mousedown: 鼠标按下

> 按下任意鼠标按钮触发, 不能通过键盘触发

#### 6. mouseup: 鼠标释放

> 释放鼠标按钮触发, 不能通过键盘触发

#### 7. click: 点击事件

> 用户单击主鼠标按钮(一般为左边按钮) 或 按下回车键触发

#### 8. dblclick: 双击事件

> 在用户双击主鼠标按钮(一般为左边按钮)触发

#### 9. mousemove: 鼠标移动

> 鼠标指针在元素内部移动时重复触发































