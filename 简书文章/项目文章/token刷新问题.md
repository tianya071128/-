## 前言

目前登录有很多用的是token机制, 因为安全性问题, 一般都会返回一个刷新token 和 使用的token, 还有过期时间, 可以根据过期时间, 当现有token失效时, 重新获取新的token

![token机制](./image/token机制.png 'token机制')

当token失效或即将失效时, 重新获取新的token, 但因为ajax是异步的, 请求新的token是需要一定时间, 此时若是有新的请求接口, 就会出现问题

在网上查询资料后, 一般有两种方法可以实现无痛刷新token机制: 

* 在请求拦截中, 拦截刷新token时, 将额外接口缓存, 刷新成功后在重新发送请求
* 在响应拦截中, 将额外接口缓存,  刷新成功后在重新发送请求

> **因为一开始找到的方法就是第二种, 所以直接使用第二种方法**
>
> **此方法有一个缺点: 就是缓存接口会请求二次, 消耗性能**

## 解决思路

大致思路: 

> * 判断token是否过期 以及 是否即将过期
>
> * 过期后, 发送刷新token请求, 请求成功后, 在重新请求之前的请求

























